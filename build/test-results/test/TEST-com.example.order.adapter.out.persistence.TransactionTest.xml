<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="com.example.order.adapter.out.persistence.TransactionTest" tests="2" skipped="0" failures="0" errors="0" timestamp="2026-02-05T15:02:23" hostname="MacBook-Pro-3.local" time="0.015">
  <properties/>
  <testcase name="createOrder_WithValidData_ShouldPersistOrderAndItems()" classname="com.example.order.adapter.out.persistence.TransactionTest" time="0.009"/>
  <testcase name="transaction_ShouldRollbackOnError()" classname="com.example.order.adapter.out.persistence.TransactionTest" time="0.006"/>
  <system-out><![CDATA[2026-02-06T00:02:23.731+09:00  INFO 58699 --- [order-service] [    Test worker] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.example.order.adapter.out.persistence.TransactionTest]: TransactionTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2026-02-06T00:02:23.731+09:00  INFO 58699 --- [order-service] [    Test worker] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.example.order.OrderApplication for test class com.example.order.adapter.out.persistence.TransactionTest
2026-02-06T00:02:23.734+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.734+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@1c4ea118 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.734+09:00  WARN 58699 --- [order-service] [    Test worker] io.r2dbc.h2.H2Connection                 : Option{name='readOnly', sensitive=false} + isn't supported in H2 at the transaction level. You must set it on conenction URL. See http://www.h2database.com/html/features.html#read_only
2026-02-06T00:02:23.734+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT orders.* FROM orders WHERE orders.ID = $1 LIMIT 2 {1: '0a3120d1-17d2-417d-996d-768eaf7dfe1b'}
2026-02-06T00:02:23.734+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@7d821bd9 columns: 9 rows: 0 pos: -1
2026-02-06T00:02:23.735+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  INSERT INTO orders (ID, customer_id, customer_email, status, total_amount, currency, created_at, updated_at) VALUES ($1, $2, $3, $4, $5, $6, $7, $8) {1: '0a3120d1-17d2-417d-996d-768eaf7dfe1b', 2: 'CUST-001', 3: 'test@example.com', 4: 'PENDING', 5: 199.98, 6: 'USD', 7: TIMESTAMP WITH TIME ZONE '2026-02-05 15:02:23.734068+00', 8: TIMESTAMP WITH TIME ZONE '2026-02-05 15:02:23.734068+00'}
2026-02-06T00:02:23.735+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  INSERT INTO order_items (order_id, product_id, product_name, quantity, unit_price, currency) VALUES ($1, $2, $3, $4, $5, $6) {1: '0a3120d1-17d2-417d-996d-768eaf7dfe1b', 2: 'PROD-001', 3: 'Test Product', 4: 2, 5: 99.99, 6: 'USD'}
2026-02-06T00:02:23.735+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT orders.* FROM orders WHERE orders.ID = $1 LIMIT 2 {1: '0a3120d1-17d2-417d-996d-768eaf7dfe1b'}
2026-02-06T00:02:23.735+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@2755f323 columns: 9 rows: 1 pos: -1
2026-02-06T00:02:23.735+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT order_items.* FROM order_items WHERE order_items.order_id = $1 {1: '0a3120d1-17d2-417d-996d-768eaf7dfe1b'}
2026-02-06T00:02:23.735+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@3fb6d686 columns: 7 rows: 1 pos: -1
2026-02-06T00:02:23.736+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  INSERT INTO outbox (aggregate_type, aggregate_id, event_type, payload, created_at, processed) VALUES ($1, $2, $3, $4, $5, $6) {1: 'Order', 2: '0a3120d1-17d2-417d-996d-768eaf7dfe1b', 3: 'OrderCreatedEvent', 4: '{"orderId":"0a3120d1-17d2-417d-996d-768eaf7dfe1b","customerEmail":"test@example.com","totalAmount":{"amount":199.98,"currency":"USD"},"createdAt":"2026-02-05T15:02:23.734068Z"}', 5: TIMESTAMP WITH TIME ZONE '2026-02-05 15:02:23.735875+00', 6: FALSE}
2026-02-06T00:02:23.736+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  COMMIT
2026-02-06T00:02:23.736+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.736+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@1514c417 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.736+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.736+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@65aa0c39 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.736+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT COUNT(*) FROM orders WHERE id = $1 {1: '0a3120d1-17d2-417d-996d-768eaf7dfe1b'}
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@3bf4390d columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@4fc3ac1 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@5b9beac9 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT COUNT(*) FROM order_items WHERE order_id = $1 {1: '0a3120d1-17d2-417d-996d-768eaf7dfe1b'}
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@58dc1aaa columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.739+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@71f83fd1 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@136e7b1c columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  DELETE FROM order_items
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@79e12f24 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@71c6bf20 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  DELETE FROM orders
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.740+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@6453dcc3 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.743+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.743+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@6caca8ed columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.743+09:00  WARN 58699 --- [order-service] [    Test worker] io.r2dbc.h2.H2Connection                 : Option{name='readOnly', sensitive=false} + isn't supported in H2 at the transaction level. You must set it on conenction URL. See http://www.h2database.com/html/features.html#read_only
2026-02-06T00:02:23.743+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT orders.* FROM orders WHERE orders.ID = $1 LIMIT 2 {1: '816fc897-d801-4da8-adce-a23e1db2ce85'}
2026-02-06T00:02:23.743+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@2f6a0f9c columns: 9 rows: 0 pos: -1
2026-02-06T00:02:23.743+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  INSERT INTO orders (ID, customer_id, customer_email, status, total_amount, currency, created_at, updated_at) VALUES ($1, $2, $3, $4, $5, $6, $7, $8) {1: '816fc897-d801-4da8-adce-a23e1db2ce85', 2: 'CUST-ROLLBACK', 3: 'rollback@example.com', 4: 'PENDING', 5: 199.98, 6: 'USD', 7: TIMESTAMP WITH TIME ZONE '2026-02-05 15:02:23.743233+00', 8: TIMESTAMP WITH TIME ZONE '2026-02-05 15:02:23.743233+00'}
2026-02-06T00:02:23.744+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  INSERT INTO order_items (order_id, product_id, product_name, quantity, unit_price, currency) VALUES ($1, $2, $3, $4, $5, $6) {1: '816fc897-d801-4da8-adce-a23e1db2ce85', 2: 'PROD-001', 3: 'Test Product', 4: 2, 5: 99.99, 6: 'USD'}
2026-02-06T00:02:23.744+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT orders.* FROM orders WHERE orders.ID = $1 LIMIT 2 {1: '816fc897-d801-4da8-adce-a23e1db2ce85'}
2026-02-06T00:02:23.744+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@718b10c2 columns: 9 rows: 1 pos: -1
2026-02-06T00:02:23.744+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT order_items.* FROM order_items WHERE order_items.order_id = $1 {1: '816fc897-d801-4da8-adce-a23e1db2ce85'}
2026-02-06T00:02:23.744+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@257ec110 columns: 7 rows: 1 pos: -1
2026-02-06T00:02:23.744+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  INSERT INTO outbox (aggregate_type, aggregate_id, event_type, payload, created_at, processed) VALUES ($1, $2, $3, $4, $5, $6) {1: 'Order', 2: '816fc897-d801-4da8-adce-a23e1db2ce85', 3: 'OrderCreatedEvent', 4: '{"orderId":"816fc897-d801-4da8-adce-a23e1db2ce85","customerEmail":"rollback@example.com","totalAmount":{"amount":199.98,"currency":"USD"},"createdAt":"2026-02-05T15:02:23.743233Z"}', 5: TIMESTAMP WITH TIME ZONE '2026-02-05 15:02:23.744857+00', 6: FALSE}
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  ROLLBACK
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@473ae517 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@76ce38f5 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT COUNT(*) FROM orders WHERE customer_id = $1 {1: 'CUST-ROLLBACK'}
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@195332ed columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.746+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@2e862e83 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@294c39a0 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  DELETE FROM order_items
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@3e87d5da columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@1a3bebf9 columns: 1 rows: 1 pos: -1
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  DELETE FROM orders
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Request:  SELECT CURRENT_TIMESTAMP
2026-02-06T00:02:23.747+09:00 DEBUG 58699 --- [order-service] [    Test worker] io.r2dbc.h2.client.SessionClient         : Response: org.h2.result.LocalResult@6b238c47 columns: 1 rows: 1 pos: -1
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
